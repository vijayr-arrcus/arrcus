bcm_l2_addr_add

bcm78900_b0_ltsw_l2_addr_add
   xgs_ltsw_l2_addr_add

    if (l2addr_tmp.flags & BCM_L2_L3LOOKUP) {
      rv = l2_station_insert(unit, &l2addr_tmp);
    } else {
      rv = l2_station_delete(unit, l2addr_tmp.mac,
                             l2addr_tmp .vid, &l2_l3_flag);
    }




L2_VFI_MY_STATION

lt traverse -l @L2_VFI_FDB
lt traverse -l @L2_VFI_FDB

Traverse table [L2_VFI_FDB]:
    HIT_DST_MAC=0
    HIT_SRC_MAC=0
    DVP=0
    PENDING=0
    STATIC=0
    TRUST_SRC_INT_PRI=0
    SRC_DROP=0
    COPY_TO_CPU=0
    DST_DROP=0
    INT_PRI=0
    ASSIGN_INT_PRI=0
    CLASS_ID=0
    MODPORT=0xbc(188)
    DEST_TYPE=PORT
    MAC_ADDR=0xe8c5_7a8f913f
    VFI_ID=0xf7e(3966)
  1 entry traversed.
exit;
exit;

BCM.0>
BCM.0> l2 show
l2 show
mac=e8:c5:7a:8f:91:3f vlan=3966 GPORT=0xbc modid=0 port=188/cd18 Hit
BCM.0>
BCM.0>


L2_VFI_MY_STATION_MODPORT
  17 fields (8 key-type fields):
    COPY_TO_CPU
    DROP
    MPLS_TERMINATION
    ARP_RARP_TERMINATION
    IPV4_MC_TERMINATION
    IPV4_TERMINATION
    IPV6_MC_TERMINATION
    IPV6_TERMINATION
    ENTRY_PRIORITY
    OVERLAY_MASK (key)
    OVERLAY (key)
    MODPORT_MASK (key)
    MODPORT (key)
    MAC_ADDR_MASK (key)
    MAC_ADDR (key)
    VFI_ID_MASK (key)
    VFI_ID (key)
L2_VFI_MY_STATION
  15 fields (6 key-type fields):
    COPY_TO_CPU
    DROP
    MPLS_TERMINATION
    ARP_RARP_TERMINATION
    IPV4_MC_TERMINATION
    IPV4_TERMINATION
    IPV6_MC_TERMINATION
    IPV6_TERMINATION
    ENTRY_PRIORITY
    OVERLAY_MASK (key)
    OVERLAY (key)
    MAC_ADDR_MASK (key)
    MAC_ADDR (key)
    VFI_ID_MASK (key)
    VFI_ID (key)
L2_VFI_MY_STATION_TRUNK
  17 fields (8 key-type fields):
    COPY_TO_CPU
    DROP
    MPLS_TERMINATION
    ARP_RARP_TERMINATION
    IPV4_MC_TERMINATION
    IPV4_TERMINATION
    IPV6_MC_TERMINATION
    IPV6_TERMINATION
    ENTRY_PRIORITY
    OVERLAY_MASK (key)
    OVERLAY (key)
    TRUNK_ID_MASK (key)
    TRUNK_ID (key)
    MAC_ADDR_MASK (key)
    MAC_ADDR (key)
    VFI_ID_MASK (key)
    VFI_ID (key)



BCMINT_L2_MY_STATION_ID

l2_station_insert(int unit, bcm_l2_addr_t *l2addr)

    lt_underlay_info = xgs_ltsw_l2_lt_info_get(unit, BCMINT_L2_UNDERLAY_MY_STATION_ID);
    if (lt_underlay_info == NULL) {
        lt_info = xgs_ltsw_l2_lt_info_get(unit, BCMINT_L2_MY_STATION_ID);
        SHR_NULL_CHECK(lt_info, SHR_E_UNAVAIL);
    }


bcm78900_b0_l2_lt_tbls_info
    {
        BCMINT_L2_UNDERLAY_MY_STATION_ID, L2_VFI_UNDERLAY_MY_STATIONt,
        L2_VFI_UNDERLAY_MY_STATIONs, L2_VFI_UNDERLAY_MY_STATIONt_FIELD_COUNT,
        l2_underlay_my_station_map, COUNTOF(l2_underlay_my_station_map)
    M.0>
BCM.0> dump chg MY_STATION
dump chg MY_STATION
Unknown option to dump (use 'help dump' for more info)
BCM.0>
BCM.0> bsh
bsh
lt traverse -l L2_VFI_UNDERLAY_MY_STATION
lt traverse -l L2_VFI_UNDERLAY_MY_STATION

Traverse table [L2_VFI_UNDERLAY_MY_STATION]:
    COPY_TO_CPU=0
    DROP=0
    MPLS_TERMINATION=1
    ARP_RARP_TERMINATION=1
    IPV4_MC_TERMINATION=0
    IPV4_TERMINATION=1
    IPV6_MC_TERMINATION=0
    IPV6_TERMINATION=1
    ENTRY_PRIORITY=0
    MAC_ADDR_MASK=0xffff_ffffffff
    MAC_ADDR=0x5c07_58a4e003
    VFI_ID_MASK=0
    VFI_ID=0
  1 entry traversed.
exit;
exit;

BCM.0>
BCM.0> l2 station show
l2 station show
        SID=0
        Priority=0
        MAC=5c:7:58:a4:e0:3
        MAC MASK=ff:ff:ff:ff:ff:ff
        VLAN=0x0
        VLAN MASK=0x0
        Inner VLAN=0x0
        Inner VLAN MASK=0x0
        VFI=0x0
        VFI MASK=0x0
        SourcePort=0x0
        SourcePort MASK=0x0
        IPv4
        IPv6
        ArpRarp
        Mpls

BCM.0>
BCM.0>


rv = bcm_vlan_create(unit, vlan_id);
		xgs_ltsw_vfi_create

BCM.0>
BCM.0> vlan show
vlan show
vlan 1  ports none (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000), untagged none (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000) MCAST_FLOOD_UNKNOWN
vlan 3966       ports cpu,cd18 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000001), untagged cd18 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000) MCAST_FLOOD_UNKNOWN
vlan 4095       ports none (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000), untagged none (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000) MCAST_FLOOD_ALL
BCM.0>
BCM.0> bsh
bsh
lt traverse -l @VFI
lt traverse -l @VFI

Traverse table [VFI]:
    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=0
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=0
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=0
    MPLS=1
    L3_IIF_ID=1
    VFI_ID=1

    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=0
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=0
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=2
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=2
    VFI_ING_MEMBER_PORTS_PROFILE_ID=2
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=0
    MPLS=1
    L3_IIF_ID=1
    VFI_ID=0xf7e(3966)

    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=1
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=1
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=1
    MPLS=1
    L3_IIF_ID=0
    VFI_ID=0xfff(4095)
  3 entries traversed.


bcm_vlan_port_add
	vlan_port_add
		xgs_ltsw_vfi_port_add
			vlan_entry_port_set

BCM.0>
BCM.0> bsh
bsh
lt list VFI_ING
lt list VFI_ING

VFI_ING_MEMBER_PORTS_PROFILE
  2 fields (1 key-type field):
    MEMBER_PORTS
    VFI_ING_MEMBER_PORTS_PROFILE_ID (key)
VFI_ING_ADAPT_OVID_PORT_GRP
  6 fields (2 key-type fields):
    CTR_ING_EFLEX_ACTION
    CTR_ING_EFLEX_OBJECT
    PORT_SVP_ID
    VFI_ID
    PORT_GRP (key)
    OVID (key)
VFI_ING_EGR_MEMBER_PORTS_PROFILE
  2 fields (1 key-type field):
    EGR_MEMBER_PORTS
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID (key)
lt traverse -l VFI_ING_MEMBER_PORTS_PROFILE
lt traverse -l VFI_ING_MEMBER_PORTS_PROFILE

Traverse table [VFI_ING_MEMBER_PORTS_PROFILE]:
    MEMBER_PORTS[0-351]=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0

    MEMBER_PORTS[0]=1,MEMBER_PORTS[1-187]=0,MEMBER_PORTS[188]=1,MEMBER_PORTS[189-351]=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=2
  2 entries traversed.
lt traverse -l @VFI
lt traverse -l @VFI

Traverse table [VFI]:
    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=0
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=0
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=0
    MPLS=1
    L3_IIF_ID=1
    VFI_ID=1

    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=0
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=0
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=2
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=2
    VFI_ING_MEMBER_PORTS_PROFILE_ID=2
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=0
    MPLS=1
    L3_IIF_ID=1
    VFI_ID=0xf7e(3966)

    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=1
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=1
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=1
    MPLS=1
    L3_IIF_ID=0
    VFI_ID=0xfff(4095)
  3 entries traversed.

BCM.0>
BCM.0> bsh
bsh
lt list VFI_ING
lt list VFI_ING

VFI_ING_MEMBER_PORTS_PROFILE
  2 fields (1 key-type field):
    MEMBER_PORTS
    VFI_ING_MEMBER_PORTS_PROFILE_ID (key)
VFI_ING_ADAPT_OVID_PORT_GRP
  6 fields (2 key-type fields):
    CTR_ING_EFLEX_ACTION
    CTR_ING_EFLEX_OBJECT
    PORT_SVP_ID
    VFI_ID
    PORT_GRP (key)
    OVID (key)
VFI_ING_EGR_MEMBER_PORTS_PROFILE
  2 fields (1 key-type field):
    EGR_MEMBER_PORTS
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID (key)
lt traverse -l VFI_ING_MEMBER_PORTS_PROFILE
lt traverse -l VFI_ING_MEMBER_PORTS_PROFILE

Traverse table [VFI_ING_MEMBER_PORTS_PROFILE]:
    MEMBER_PORTS[0-351]=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0

    MEMBER_PORTS[0]=1,MEMBER_PORTS[1-187]=0,MEMBER_PORTS[188]=1,MEMBER_PORTS[189-351]=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=2
  2 entries traversed.
lt traverse -l @VFI
lt traverse -l @VFI

Traverse table [VFI]:
    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=0
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=0
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=0
    MPLS=1
    L3_IIF_ID=1
    VFI_ID=1

    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=0
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=0
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=2
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=2
    VFI_ING_MEMBER_PORTS_PROFILE_ID=2
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=0
    MPLS=1
    L3_IIF_ID=1
    VFI_ID=0xf7e(3966)

    CTR_EGR_EFLEX_ACTION=0
    CTR_ING_EFLEX_ACTION=0
    L3_BC_GRP_ID=0
    L3_UNKOWN_MC_GRP_ID=0
    L3_UNKOWN_UC_GRP_ID=0
    VP_REPLICATION=0
    EGR_ADAPT_PORT_GRP_MODE=PORT_GRP_ID
    EGR_OVID=0
    EGR_OVID_VALID=0
    EGR_VFI_MEMBERSHIP_CHECK=1
    NO_LEARNING=1
    VLAN_OUTER_TPID_ID=0
    PHB_EGR_VLAN_INT_PRI_TO_L2_OTAG_ID=0
    REMARK_CFI=0
    REMARK_DOT1P=0
    IGMP_MLD_SNOOPING=1
    FID=0
    FORWARDING_BEHAVIOR=BRIDGE
    VFI_ING_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0
    VFI_ING_MEMBER_PORTS_PROFILE_ID=0
    VFI_STG_ID=1
    CLASS_ID=0
    VFI_PROFILE_ID=1
    MPLS=1
    L3_IIF_ID=0
    VFI_ID=0xfff(4095)
  3 entries traversed.



lt traverse -l VFI_EGR_MEMBER_PORTS_PROFILE
lt traverse -l VFI_EGR_MEMBER_PORTS_PROFILE

Traverse table [VFI_EGR_MEMBER_PORTS_PROFILE]:
    MEMBER_PORTS[0-351]=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=0

    MEMBER_PORTS[0]=1,MEMBER_PORTS[1-187]=0,MEMBER_PORTS[188]=1,MEMBER_PORTS[189-351]=0
    VFI_EGR_MEMBER_PORTS_PROFILE_ID=2
  2 entries traversed.




lt traverse -l L3_IIF
lt traverse -l L3_IIF

Traverse table [L3_IIF]:
    CTR_ING_EFLEX_ACTION=0
    ECN_TNL_DECAP_ID=0
    INBAND_TELEMETRY_IOAM=0
    INBAND_TELEMETRY_IFA=0
    L3_MC_IIF_ID=0
    L3_OVERRIDE_IP_MC_DO_VLAN=0
    IPV4_UC=1
    IPV6_UC=1
    IPV4_MC=1
    IPV6_MC=1
    CLASS_ID=0
    L3_IP_OPTION_CONTROL_PROFILE_ID=0
    TRUST_IP_DSCP=0
    L3_IIF_PROFILE_ID=1
    VRF_ID=0
    L3_IIF_ID=1
  1 entry traversed.
Traverse table [L3_IIF_PROFILE]:
    TM_STAT[0-1]=NONE
    IP_UNKNOWN_MC_AS_L2_MC=0
    IPV6_ROUTING_HDR_TYPE_0_DROP=0
    UNRESOLVED_SIP_TO_CPU=0
    IPV6_UNKNOWN_MC_TO_CPU=0
    IPV4_UNKNOWN_MC_TO_CPU=0
    ICMP_REDIRECT_PKT_TO_CPU=0
    PHB_ING_IP_DSCP_TO_INT_PRI_REMAP_ID=0x3f(63)
    ALLOW_GLOBAL_ROUTE=0
    L3_IIF_PROFILE_ID=1
  1 entry traversed.

