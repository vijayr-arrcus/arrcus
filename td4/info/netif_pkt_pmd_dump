root@td4-5:/proc/linux_ngknet# tcpdump -i netdev-swp22  -- 102/66
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on netdev-swp22, link-type EN10MB (Ethernet), capture size 262144 bytes
08:26:10.231170 02:a0:c9:10:20:31 (oui Unknown) > 01:80:c2:00:00:0e (oui Unknown), ethertype 802.1Q (0x8100), length 240:
        0x0000:  b880 1004 0000 0088 0000 4800 0000 0066  ..........H....f
        0x0010:  8c00 0000 0000 0222 0000 0500 1101 0000  ......."........
        0x0020:  3082 0000 0200 0000 0000 0008 0000 6600  0.............f.
        0x0030:  0000 0000 0000 0000 0000 0000 0000 ff0f  ................
        0x0040:  6600 0000 0000 0000 0000 0000 5f5f 4000  f...........__@.
        0x0050:  0000 0000 0000      0180 c200 000e 02a0 c910  ................
        0x0060:  2031 8100 0000 88cc 0207 0400 a0c9 1020  .1..............
        0x0070:  3004 0605 7377 7032 3806 0200 780a 0b74  0...swp28...x..t
        0x0080:  6434 2d36 2d73 3332 6462 0c1f 4172 7263  d4-6-s32db..Arrc
        0x0090:  7573 204f 7065 7261 7469 6e67 2053 7973  us.Operating.Sys
        0x00a0:  7465 6d20 2841 7263 4f53 290e 0400 9c00  tem.(ArcOS).....
        0x00b0:  9010 0c05 010a 1b69 2902 0000 0004 0008  .......i).......
        0x00c0:  0573 7770 3238 fe09 0012 0f03 0300 003a  .swp28.........:
        0x00d0:  9cfe 0900 120f 0102 8000 0016 0000       ..............

root@td4-5:/proc/linux_ngknet# ifconfig netdev-swp10 up
root@td4-5:/proc/linux_ngknet# tcpdump -i netdev-swp10 -Qin   42/2a
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on netdev-swp10, link-type EN10MB (Ethernet), capture size 262144 bytes
21:57:15.434291 34:ef:b6:41:ef:95 (oui Unknown) > 01:80:c2:00:00:0e (oui Unknown), ethertype 802.1Q (0x8100), length 264:
        0x0000:  b880 1004 0000 00a0 0000 4800 0000 002a  ..........H....*
        0x0010:  a400 0000 0000 0222 0000 0500 1101 0000  ......."........
        0x0020:  3082 0000 0200 0000 0000 0008 0000 2a00  0.............*.
        0x0030:  0000 0000 0000 0000 0000 0000 0000 ff0f  ................
        0x0040:  2a00 0000 0000 0000 0000 0000 5f5f 4000  *...........__@.
        0x0050:  0000 0000 0000     0180 c200 000e 34ef b641  ............4..A
        0x0060:  ef95 8100 0000 88cc 0207 0434 efb6 41ef  ...........4..A.
        0x0070:  9404 0705 7377 7032 7331 0602 0078 0a07  ....swp2s1...x..
        0x0080:  7464 342d 7468 330c 1f41 7272 6375 7320  td4-th3..Arrcus.
        0x0090:  4f70 6572 6174 696e 6720 5379 7374 656d  Operating.System
        0x00a0:  2028 4172 634f 5329 0e04 009c 0090 100c  .(ArcOS)........
        0x00b0:  0501 0a1b 691d 0200 0000 0400 1018 1102  ....i...........
        0x00c0:  0192 0168 0010 0000 0000 0001 0000 0002  ...h............
        0x00d0:  0200 0001 0000 0806 7377 7032 7331 fe09  ........swp2s1..
        0x00e0:  0012 0f03 0100 0000 00fe 0900 120f 0102  ................
        0x00f0:  8000 004d 0000                           ...M..
^C
1 packet captured
1 packet received by filter
0 packets dropped by kernel
root@td4-5:/proc/linux_ngknet#


root@td4-5:/proc/linux_ngknet# tcpdump -i swp10 -xxxx
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on swp10, link-type EN10MB (Ethernet), capture size 262144 bytes
08:28:08.572008 LLDP, length 142: td4-th3
        0x0000:  0180 c200 000e 34ef b641 ef95 88cc 0207
        0x0010:  0434 efb6 41ef 9404 0705 7377 7032 7331
        0x0020:  0602 0078 0a07 7464 342d 7468 330c 1f41
        0x0030:  7272 6375 7320 4f70 6572 6174 696e 6720
        0x0040:  5379 7374 656d 2028 4172 634f 5329 0e04
        0x0050:  009c 0090 100c 0501 0a1b 691d 0200 0000
        0x0060:  0400 1018 1102 0192 0168 0010 0000 0000
        0x0070:  0001 0000 0002 0200 0000 c300 0806 7377
        0x0080:  7032 7331 fe09 0012 0f03 0100 0000 00fe
        0x0090:  0900 120f 0102 8000 004d 0000
08:28:08.582273 LLDP, length 112: td4-5
        0x0000:  0180 c200 000e e8c5 7ab1 2724 88cc 0207
        0x0010:  04e8 c57a b127 2304 0605 7377 7031 3006
        0x0020:  0200 780a 0574 6434 2d35 0c1f 4172 7263
        0x0030:  7573 204f 7065 7261 7469 6e67 2053 7973
        0x0040:  7465 6d20 2841 7263 4f53 290e 0400 9c00
        0x0050:  1010 0c05 010a 1b69 2702 0000 0004 0008
        0x0060:  0573 7770 3130 fe09 0012 0f03 0100 0000
        0x0070:  00fe 0900 120f 0102 8000 004d 0000
^C
2 packets captured

arc-mac-learn interface
========================
packet ingress on port- 80 WITH MAC MOVE

13:20:00.568213 00:00:00:00:00:03 (oui Ethernet) > ab:cd:ab:cd:ab:cd (oui Unknown), ethertype 802.1Q (0x8100), length 259:
        0x0000:  b880 1004 0000 009b 0000 4800 0000 2850  ..........H...(P
        0x0010:  9f00 0000 0000 2a00 0000 0500 3101 0000  ......*.....1...
        0x0020:  3080 0000 0200 0000 0000 0208 0000 5000  0.............P.
        0x0030:  0000 0000 0000 0000 0000 0000 0000 3200  ..............2.
        0x0040:  5000 0000 0000 0000 0000 0000 0202 0400  P...............
        0x0050:  0000 0000 0000 abcd abcd abcd 0000 0000  ................
        0x0060:  0003 8100 0032 0089 db34 a17f 0000 0000  .....2...4......
        0x0070:  5f60 5eac 6364 62b0 6768 66b4 6b6c 6ab8  _`^.cdb.ghf.klj.
        0x0080:  6f70 6ebc 7374 72c0 7778 76c4 7b7c 7ac8  opn.str.wxv.{|z.
        0x0090:  7f80 7ecc 8384 82d0 8788 86d4 8b8c 8ad8  ..~.............
        0x00a0:  8f90 8edc 9394 92e0 9798 96e4 9b9c 9ae8  ................
        0x00b0:  9fa0 9eec a3a4 a2f0 a7a8 a6f4 abac aaf8  ................
        0x00c0:  afb0 aefc b3b4 b300 b7b8 b704 bbbc bb08  ................
        0x00d0:  bfc0 bf0c c3c4 c310 c7c8 c714 cbcc cb18  ................
        0x00e0:  cfd0 cf1c d3d4 d320 d7d8 d724 dbdc db28  ...........$...(
        0x00f0:  df
packet ingress on port- 82 - 52 WITH MAC MOVE

13:24:12.516380 00:00:00:00:00:01 (oui Ethernet) > ab:cd:ab:cd:ab:cd (oui Unknown), ethertype 802.1Q (0x8100), length 259:
        0x0000:  b880 1004 0000 009b 0000 4800 0000 2852  ..........H...(R
        0x0010:  9f00 0000 0000 2a00 0000 0500 3101 0000  ......*.....1...
        0x0020:  3080 0000 0200 0000 0000 0208 0000 5200  0.............R.
        0x0030:  0000 0000 0000 0000 0000 0000 0000 3200  ..............2.
        0x0040:  5200 0000 0000 0000 0000 0000 0202 0400  R...............
        0x0050:  0000 0000 0000 abcd abcd abcd 0000 0000  ................
        0x0060:  0001 8100 0032 0089 db34 a17f 0000 0000  .....2...4......
        0x0070:  c3c4 c2ac c7c8 c6b0 cbcc cab4 cfd0 ceb8  ................
        0x0080:  d3d4 d2bc d7d8 d6c0 dbdc dac4 dfe0 dec8  ................
        0x0090:  e3e4 e2cc e7e8 e6d0 ebec ead4 eff0 eed8  ................
        0x00a0:  f3f4 f2dc f7f8 f6e0 fbfc fae4 0000 fee8  ................
        0x00b0:  0405 02ec 0809 06f0 0c0d 0af4 1011 0ef8  ................
        0x00c0:  1415 12fc 1819 1700 1c1d 1b04 2021 1f08  .............!..
        0x00d0:  2425 230c 2829 2710 2c2d 2b14 3031 2f18  $%#.()'.,-+.01/.
        0x00e0:  3435 331c 3839 3720 3c3d 3b24 4041 3f28  453.897.<=;$@A?(
        0x00f0:  44


Packet ingress on port 82 without macmove.
18:21:23.759067 00:00:00:00:00:01 (oui Ethernet) > ab:cd:ab:cd:ab:cd (oui Unknown), ethertype 802.1Q (0x8100), length 168:
                                diff                52=port
        0x0000:  b880 1004 0000 0040 0000 4800 0000 2852  .......@..H...(R
            4400 = looks like pkt length
        0x0010:  4400 0000 0000 2a00 0000 0500 3101 0000  D.....*.....1...

        0x0020:  3080 0000 0200 0000 0000 0308 0000 5200  0.............R.
        0x0030:  0000 0000 0000 0000 0000 0000 0000 3200  ..............2.
        0x0040:  5200 0000 0000 0000 0000 0000 0202 0400  R...............
        0x0050:  0000 0000 0000 abcd abcd abcd 0000 0000  ................
        0x0060:  0001 8100 0032 002e 0000 0000 0000 0000  .....2..........
        0x0070:  c0c1 c154 c4c5 c558 c8c9 c95c cccd cd60  ...T...X...\...`
        0x0080:  d0d1 d164 d4d5 d568 d8d9 d96c dcdd dd70  ...d...h...l...p
        0x0090:  e0e1 e174 e4e5


3080 0000 0200 0000 0000 0208 0000 5200 0000 0000 0000

0x00008030 0x00000002 0x08020000 0x00520000 0x00000000 0x0000
0x00480100 0x00000000 0x00500a22 0x01010005 0x81300000

3080 0000 0200 0000 0000 0208 0000 5200 0000 0000 0000

0000 0000 0000 0000 3200 5200 0000 0000 0000 0000 0000 0202 0400 0000 0000 0000

3080 0000 0200 0000 0000 0208 0000 5200
0000 0000 0000 0000 0000 0000 0000 3200
5200 0000 0000 0000 0000 0000 0202 0400
0000 0000 0000 abcd abcd abcd 0000 0000


With normal tcpdump -i swp18

04:51:39.765377 00:00:00:00:00:01 (oui Ethernet) > ab:cd:ab:cd:ab:cd (oui Unknown), ethertype 802.1Q (0x8100), length
259:
        0x0000:  b880 1004 0000 009b 0000 4800 0000 2852  ..........H...(R
        0x0010:  9f00 0000 0000 2a00 0000 0500 3101 0000  ......*.....1...
        0x0020:  3080 0000 0200 0000 0000 0208 0000 5200  0.............R.
        0x0030:  0000 0000 0000 0000 0000 0000 0000 3200  ..............2.
        0x0040:  5200 0000 0000 0000 0000 0000 0202 0400  R...............
        0x0050:  0000 0000 0000 abcd abcd abcd 0000 0000  ................
        0x0060:  0001 8100 0032 0089 0000 0000 0000 0000  .....2..........
        0x0070:  4445 4604 4849 4a08 4c4d 4e0c 5051 5210  DEF.HIJ.LMN.PQR.
        0x0080:  5455 5614 5859 5a18 5c5d 5e1c 6061 6220  TUV.XYZ.\]^.`ab.
        0x0090:  6465 6624 6869 6a28 6c6d 6e2c 7071 7230  def$hij(lmn,pqr0
        0x00a0:  7475 7634 7879 7a38 7c7d 7e3c 8081 8240  tuv4xyz8|}~<...@
        0x00b0:  8485 8644 8889 8a48 8c8d 8e4c 9091 9250  ...D...H...L...P
        0x00c0:  9495 9654 9899 9a58 9c9d 9e5c a0a1 a260  ...T...X...\...`
        0x00d0:  a4a5 a664 a8a9 aa68 acad ae6c b0b1 b270  ...d...h...l...p
        0x00e0:  b4b5 b674 b8b9 ba78 bcbd be7c c0c1 c280  ...t...x...|....
        0x00f0:  c4


with xxxvvvv

05:14:10.731058 00:00:00:00:00:01 (oui Ethernet) > ab:cd:ab:cd:ab:cd (oui Unknown), ethertype 802.1Q (0x8100), length
259:
        0x0000:  abcd abcd abcd 0000 0000 0001 8100 0001
        0x0010:  de08 b880 1004 0000 009b 0000 4800 0000
        0x0020:  2852 9f00 0000 0000 2a00 0000 0500 3101
        0x0030:  0000 3080 0000 0200 0000 0000 0208 0000
        0x0040:  5200 0000 0000 0000 0000 0000 0000 0000
        0x0050:  3200 5200 0000 0000 0000 0000 0000 0202
        0x0060:  0400 0000 0000 0000 abcd abcd abcd 0000
        0x0070:  0000 0001 8100 0032 0089 0000 0000 0000
        0x0080:  0000 e7e8 e984 ebec ed88 eff0 f18c f3f4
        0x0090:  f590 f7f8 f994 fbfc fd98 0001 019c 0405
        0x00a0:  05a0 0809 09a4 0c0d 0da8 1011 11ac 1415
        0x00b0:  15b0 1819 19b4 1c1d 1db8 2021 21bc 2425
        0x00c0:  25c0 2829 29c4 2c2d 2dc8 3031 31cc 3435
        0x00d0:  35d0 3839 39d4 3c3d 3dd8 4041 41dc 4445
        0x00e0:  45e0 4849 49e4 4c4d 4de8 5051 51ec 5455
        0x00f0:  55f0 5859 59f4 5c5d 5df8 6061 61fc 6465
        0x0100:  6600 68

        without RCPU header
08:08:23.398451 00:00:00:00:00:01 (oui Ethernet) > ab:cd:ab:cd:ab:cd (oui Unknown), ethertype 802.1Q (0x8100), length
155: vlan 50, p 0, LLC, dsap Null (0x00) Individual, ssap Null (0x00) Command, ctrl 0x0000: Information, send seq 0, rcv seq 0, Flags [Command], length 137
        0x0000:  abcd abcd abcd 0000 0000 0001 8100 0032
        0x0010:  0089 0000 0000 0000 0000 9293 9484 9697
        0x0020:  9888 9a9b 9c8c 9e9f a090 a2a3 a494 a6a7
        0x0030:  a898 aaab ac9c aeaf b0a0 b2b3 b4a4 b6b7
        0x0040:  b8a8 babb bcac bebf c0b0 c2c3 c4b4 c6c7
        0x0050:  c8b8 cacb ccbc cecf d0c0 d2d3 d4c4 d6d7
        0x0060:  d8c8 dadb dccc dedf e0d0 e2e3 e4d4 e6e7
        0x0070:  e8d8 eaeb ecdc eeef f0e0 f2f3 f4e4 f6f7
        0x0080:  f8e8 fafb fcec ff00 00f0 0304 04f4 0708
        0x0090:  08f8 0b0c 0cfc 0f10 1100 13



         2852 9f00 0000 0000 2a00 0000 0500 3101 0000 3080 0000 0200 0000 0000 0208 0000 5200 0000 0000 0000 0000 0000 0000 0000 3200 5200 0000 0000 0000 0000 0000 0202 0400 0000 0000 0000 
         0x009f5228 0x00000000 0x0000002a 0x01310005 0x80300000 0x00020000 0x00000000 0x00000800 0x00000052 0x00000000 0x00000000 0x00000000 0x00520032 0x00000000 0x00000000 0x02020000 0x00000004 0x00000000

         0x009f5228, 0x00000000, 0x0000002a, 0x01310005, 0x80300000, 0x00020000, 0x00000000, 0x00000800 ,0x00000052 ,0x00000000 ,0x00000000 ,0x00000000 ,0x00520032 ,0x00000000 ,0x00000000 ,0x02020000 ,0x00000004 ,0x00000000

         0x009f5228000000000000002a013100058030000000020000000000000000080000000052000000000000000000000000005200320000000000000000020200000000000400000000 
         2852 9f00 0000 0000 2a00 0000 0500 3101 0000 3080 0000 0200 0000 0000 0208 0000 5200 0000 0000 0000 0000 0000 0000 0000 3200 5200 0000 0000 0000 0000 0000 0202 0400 0000 0000 0000 

pmddecode rxpmd          0x009f5228 0x00000000 0x0000002a 0x01310005 0x80300000 0x00020000 0x00000000 0x00000800 0x00000052 0x00000000 0x00000000 0x00000000 0x00520032 0x00000000 0x00000000 0x02020000 0x00000004 0x00000000     [1308/1846]
0x9f5228 0x0 0x2a 0x1310005 0x80300000 0x20000 0x0 0x802 0x52 0x0 0x0 0x0 0x520032 0x0 0x0 0x2020000 0x4 0x0 0xcdabcdab 0xcdab 0x1000000 0x32000081 0x8900 0x0 0xb1b04d78 0xb5b484b2 0xb9b888b6 0xbdbc8cba 0xc1c090be 0xc5c494c2 0xc9c898c6 0xcdcc9cca 0xd1d0a0ce 0xd5d4a4d2 0xd9d8a8d6 0xdddcacda 0xe1e0b0de 0xe5e4b4e2 0xe9e8b8e6 0xedecbcea 0xf1f0c0ee 0xf5f4c4f2 0xf9f8c8f6 0xfdfcccfa 0x201d0fe 0x605d402 0xa09d806 0xe0ddc0a 0x1211e00e 0x1615e412

[RXPMD information]
        UNICAST_QUEUE=0
        QUEUE_NUM=0xa
        PKT_LENGTH=0x9f
        SRC_PORT_NUM=0x52
        L3ONLY=0
        IP_ROUTED=0
        UC_SW_COPY_DROPPED=0
        SWITCH=1
        REPLICATION_OR_NHOP_INDEX=0
        MATCH_ID_LO=0x2a
        MATCH_ID_HI=0
        MPB_FLEX_DATA_TYPE=5
        INT_CN=0
        CNG=0
        EGR_ZONE_REMAP_CTRL=1
        DMA_HEADER_VERSION=0
        MULTICAST=1
        COPY_TO_CPU=1
        TRUNCATE_CPU_COPY=1
[FLEX fields]
        DLB_ECMP_DESTINATION_15_0=0
        DROP_CODE_15_0=0x202
        DVP_15_0=0
        EFFECTIVE_TTL_7_0=0
        ENTROPY_LABEL_HIGH_3_0=0
        ENTROPY_LABEL_LOW_15_0=0
        EVENT_TRACE_VECTOR_31_0=4
        EVENT_TRACE_VECTOR_47_32=0
        I2E_CLASS_ID_15_0=0
        IFP_IOAM_GBP_ACTION_3_0=0
        IFP_TS_CONTROL_ACTION_3_0=0
        ING_TIMESTAMP_31_0=0
        INGRESS_PP_PORT_7_0=0x52
        INGRESS_QOS_REMAP_VALUE_OR_IFP_OPAQUE_OBJ_15_0=0
        INGRESS_QOS_REMARK_CTRL_3_0=0
        INT_PRI_3_0=0
        L2_OIF_10_0=0
        L3_IIF_13_0=0
        L3_OIF_1_13_0=0
        MPLS_LABEL_DECAP_COUNT_3_0=8
        NHOP_2_OR_ECMP_GROUP_INDEX_1_15_0=0
        NHOP_INDEX_1_15_0=0
        PARSER_VHLEN_0_15_0=0
        PKT_MISC_CTRL_0_3_0=0
        SVP_15_0=0
        SVP_NETWORK_GROUP_BITMAP_3_0=0
        SYSTEM_DESTINATION_15_0=0x800
        SYSTEM_OPCODE_3_0=3
        SYSTEM_SOURCE_15_0=0x52
        TIMESTAMP_CTRL_3_0=0
        TUNNEL_PROCESSING_RESULTS_1_3_0=0
        VFI_15_0=0x32
        VLAN_TAG_PRESERVE_CTRL_SVP_MIRROR_ENABLE_1_0=2
[RX reasons]
        L2_SRC_STATIC_MOVE

abcd abcd abcd 0000


[114456.304227] Rx packet (270 bytes).
[114456.305805] 0000: abcdabcd abcd0000 00000004 81000001 de08b880 20040000 009b0000 10000000
[114456.305810] 0020: 00000081 52000000 00600000 00000000 abcdabcd abcd0000 00000004 81000032
[114456.310338] 0000: 00000000 00000000 00000000 00000000 00000000 00000000 a6000000 48000000
[114456.310342] 0020: 0078a600 00000000 02220000 05001101 00003082 00000200 00000000 04080000
[114456.315391] 0040: 00890000 00000000 0000191a 1a041d1e 1e082122 220c2526 2610292a 2a142d2e
[114456.315396] 0060: 2e183132 321c3536 3620393a 3a243d3e 3e284142 422c4546 4630494a 4a344d4e
[114456.323651] 0040: 78000000 00000000 00000300 00000000 800f7800 00000000 00000000 00000000
[114456.323654] 0060: 40000000 00000000 0180c200 000e34ef b641ef95 81000f80 88cc0207 0434efb6
[114456.331913] 0080: 4e385152 523c5556 5640595a 5a445d5e 5e486162 624c6566 6650696a 6a546d6e
[114456.340171] 0080: 41ef9404 08057377 70323273 31060200 780a0774 64342d74 68330c1f 41727263
[114456.340174] 00a0: 7573204f 70657261 74696e67 20537973 74656d20 28417263 4f53290e 04009c00
[114456.348429] 00a0: 6e587172 725c7576 7660797a 7a647d7e 7e688182 826c8586 8670898a 8a748d8e
[114456.356691] 00c0: 10100c05 010a1b69 1d020000 00040010 18110201 40000100 01000000 00000000
[114456.364945] 00c0: 8e789192 927c9596 968099

